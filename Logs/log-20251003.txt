2025-10-03 07:54:59.273 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-10-03 07:54:59.398 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'FertilizerWarehouseAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert duplicate key row in object 'dbo.RolePermissions' with unique index 'IX_RolePermissions_Role_PermissionKey'. The duplicate key value is (admin, manage_users).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:c2acc9a9-2960-41a5-949f-4c32a85dadce
Error Number:2601,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert duplicate key row in object 'dbo.RolePermissions' with unique index 'IX_RolePermissions_Role_PermissionKey'. The duplicate key value is (admin, manage_users).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:c2acc9a9-2960-41a5-949f-4c32a85dadce
Error Number:2601,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-10-03 07:54:59.414 +07:00 [ERR] Error saving permissions for role admin
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert duplicate key row in object 'dbo.RolePermissions' with unique index 'IX_RolePermissions_Role_PermissionKey'. The duplicate key value is (admin, manage_users).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:c2acc9a9-2960-41a5-949f-4c32a85dadce
Error Number:2601,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at FertilizerWarehouseAPI.Controllers.PermissionsController.SavePermissions(SavePermissionsRequest request) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Controllers\PermissionsController.cs:line 187
2025-10-03 07:56:46.824 +07:00 [INF] Database migration completed successfully
2025-10-03 07:56:47.077 +07:00 [INF] Permissions data seeded successfully
2025-10-03 07:56:47.083 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 07:57:15.698 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 07:57:26.865 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-10-03 07:57:26.969 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-10-03 07:57:27.050 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'FertilizerWarehouseAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert duplicate key row in object 'dbo.RolePermissions' with unique index 'IX_RolePermissions_Role_PermissionKey'. The duplicate key value is (admin, manage_users).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:dfb93d24-4962-410c-bbb5-749051f95239
Error Number:2601,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert duplicate key row in object 'dbo.RolePermissions' with unique index 'IX_RolePermissions_Role_PermissionKey'. The duplicate key value is (admin, manage_users).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:dfb93d24-4962-410c-bbb5-749051f95239
Error Number:2601,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-10-03 07:57:27.068 +07:00 [ERR] Error saving permissions for role admin
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert duplicate key row in object 'dbo.RolePermissions' with unique index 'IX_RolePermissions_Role_PermissionKey'. The duplicate key value is (admin, manage_users).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:dfb93d24-4962-410c-bbb5-749051f95239
Error Number:2601,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at FertilizerWarehouseAPI.Controllers.PermissionsController.SavePermissions(SavePermissionsRequest request) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Controllers\PermissionsController.cs:line 188
2025-10-03 08:01:38.403 +07:00 [INF] Database migration completed successfully
2025-10-03 08:01:38.693 +07:00 [INF] Permissions data seeded successfully
2025-10-03 08:01:38.698 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 08:02:57.631 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 08:03:07.694 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-10-03 08:03:07.755 +07:00 [INF] Updated permissions for role admin
2025-10-03 08:03:07.816 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-10-03 08:03:07.843 +07:00 [INF] Updated permissions for role warehouse
2025-10-03 08:03:07.863 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-10-03 08:03:07.889 +07:00 [INF] Updated permissions for role team_leader
2025-10-03 08:03:07.902 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-10-03 08:03:07.918 +07:00 [INF] Updated permissions for role sales
2025-10-03 08:11:58.713 +07:00 [INF] Database migration completed successfully
2025-10-03 08:11:59.307 +07:00 [INF] Permissions data seeded successfully
2025-10-03 08:11:59.326 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 08:15:14.104 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 08:15:21.660 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-10-03 08:15:21.741 +07:00 [INF] Updated permissions for role admin
2025-10-03 08:15:21.759 +07:00 [INF] Updated permissions for role warehouse
2025-10-03 08:15:21.773 +07:00 [INF] Updated permissions for role team_leader
2025-10-03 08:15:21.785 +07:00 [INF] Updated permissions for role sales
2025-10-03 08:18:55.759 +07:00 [INF] Database migration completed successfully
2025-10-03 08:18:56.096 +07:00 [INF] Permissions data seeded successfully
2025-10-03 08:18:56.102 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 08:18:58.799 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 08:35:07.497 +07:00 [INF] Database migration completed successfully
2025-10-03 08:35:07.801 +07:00 [INF] Permissions data seeded successfully
2025-10-03 08:35:07.808 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 08:35:15.296 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 08:38:06.248 +07:00 [INF] Disabled permission all for role admin
2025-10-03 08:38:06.254 +07:00 [INF] Disabled permission create_leave_requests for role admin
2025-10-03 08:38:06.257 +07:00 [INF] Disabled permission edit_leave_requests for role admin
2025-10-03 08:38:06.259 +07:00 [INF] Disabled permission approve_leave_requests for role admin
2025-10-03 08:38:06.261 +07:00 [INF] Disabled permission reject_leave_requests for role admin
2025-10-03 08:38:06.264 +07:00 [INF] Disabled permission delete_leave_requests for role admin
2025-10-03 08:38:06.266 +07:00 [INF] Disabled permission cancel_leave_requests for role admin
2025-10-03 08:38:06.267 +07:00 [INF] Disabled permission create_notifications for role admin
2025-10-03 08:38:06.269 +07:00 [INF] Disabled permission edit_notifications for role admin
2025-10-03 08:38:06.271 +07:00 [INF] Disabled permission delete_notifications for role admin
2025-10-03 08:38:06.272 +07:00 [INF] Disabled permission send_notifications for role admin
2025-10-03 08:38:06.273 +07:00 [INF] Disabled permission create_attendance for role admin
2025-10-03 08:38:06.274 +07:00 [INF] Disabled permission edit_attendance for role admin
2025-10-03 08:38:06.275 +07:00 [INF] Disabled permission delete_attendance for role admin
2025-10-03 08:38:06.276 +07:00 [INF] Disabled permission export_attendance for role admin
2025-10-03 08:38:06.277 +07:00 [INF] Disabled permission approve_attendance for role admin
2025-10-03 08:38:06.277 +07:00 [INF] Disabled permission reject_attendance for role admin
2025-10-03 08:38:06.278 +07:00 [INF] Disabled permission view_dashboard for role admin
2025-10-03 08:38:06.279 +07:00 [INF] Disabled permission customize_dashboard for role admin
2025-10-03 08:38:06.393 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-10-03 08:38:06.533 +07:00 [INF] Updated permissions for role admin. Enabled permissions: 79
2025-10-03 08:38:06.537 +07:00 [INF] Enabled permissions: view_warehouse, edit_warehouse, manage_locations, view_cell_details, customize_warehouse, warehouse_config, use_warehouse_filters, drag_drop_position, transfer_goods, empty_cell, manage_clusters, create_cluster, view_production, manage_production, create_production_order, edit_production_order, delete_production_order, manage_machines, manage_production_schedule, view_employees, view_employee_performance, assign_staff, manage_permissions, manage_users, view_staff_info, view_reports, export_reports, view_activities, print_reports, schedule_reports, inventory_check, initiate_inventory_check, perform_inventory_check, verify_inventory_check, approve_inventory_adjustments, view_inventory_check_history, inventory_detail, view_alerts, manage_alerts, create_alert, delete_alert, manage_settings, view_products, edit_products, delete_products, import_products, export_products, track_products, manage_products, manage_inventory, view_maintenance_schedule, create_maintenance_task, assign_maintenance_task, mark_task_complete, maintenance, view_leave_requests, manage_leave_requests, view_notifications, manage_notifications, view_attendance, manage_attendance, view_import_export_orders, create_import_orders, create_export_orders, edit_import_export_orders, delete_import_export_orders, print_import_export_orders, view_suppliers, manage_suppliers, edit_suppliers, delete_suppliers, view_categories, manage_categories, edit_categories, delete_categories, view_users, edit_users, delete_users, export_dashboard
2025-10-03 08:38:06.564 +07:00 [INF] Updated permissions for role warehouse. Enabled permissions: 14
2025-10-03 08:38:06.566 +07:00 [INF] Enabled permissions: view_warehouse, view_cell_details, use_warehouse_filters, view_products, import_products, export_products, track_products, manage_inventory, view_dashboard, perform_inventory_check, view_inventory_check_history, view_leave_requests, create_leave_requests, view_notifications
2025-10-03 08:38:06.586 +07:00 [INF] Updated permissions for role team_leader. Enabled permissions: 27
2025-10-03 08:38:06.587 +07:00 [INF] Enabled permissions: view_warehouse, edit_warehouse, manage_locations, view_products, edit_products, manage_products, view_employees, view_employee_performance, view_reports, view_dashboard, view_production, manage_production, customize_warehouse, warehouse_config, view_maintenance_schedule, create_maintenance_task, initiate_inventory_check, approve_inventory_adjustments, view_alerts, view_leave_requests, create_leave_requests, approve_leave_requests, reject_leave_requests, view_notifications, create_notifications, edit_notifications, delete_notifications
2025-10-03 08:38:06.602 +07:00 [INF] Updated permissions for role sales. Enabled permissions: 9
2025-10-03 08:38:06.605 +07:00 [INF] Enabled permissions: view_products, view_warehouse, export_products, view_reports, view_dashboard, view_alerts, view_leave_requests, create_leave_requests, view_notifications
2025-10-03 08:38:17.891 +07:00 [INF] Disabled permission all for role admin
2025-10-03 08:38:17.895 +07:00 [INF] Disabled permission create_leave_requests for role admin
2025-10-03 08:38:17.897 +07:00 [INF] Disabled permission edit_leave_requests for role admin
2025-10-03 08:38:17.899 +07:00 [INF] Disabled permission approve_leave_requests for role admin
2025-10-03 08:38:17.901 +07:00 [INF] Disabled permission reject_leave_requests for role admin
2025-10-03 08:38:17.904 +07:00 [INF] Disabled permission delete_leave_requests for role admin
2025-10-03 08:38:17.906 +07:00 [INF] Disabled permission cancel_leave_requests for role admin
2025-10-03 08:38:17.907 +07:00 [INF] Disabled permission create_notifications for role admin
2025-10-03 08:38:17.908 +07:00 [INF] Disabled permission edit_notifications for role admin
2025-10-03 08:38:17.908 +07:00 [INF] Disabled permission delete_notifications for role admin
2025-10-03 08:38:17.909 +07:00 [INF] Disabled permission send_notifications for role admin
2025-10-03 08:38:17.910 +07:00 [INF] Disabled permission create_attendance for role admin
2025-10-03 08:38:17.911 +07:00 [INF] Disabled permission edit_attendance for role admin
2025-10-03 08:38:17.912 +07:00 [INF] Disabled permission delete_attendance for role admin
2025-10-03 08:38:17.913 +07:00 [INF] Disabled permission export_attendance for role admin
2025-10-03 08:38:17.914 +07:00 [INF] Disabled permission approve_attendance for role admin
2025-10-03 08:38:17.916 +07:00 [INF] Disabled permission reject_attendance for role admin
2025-10-03 08:38:17.917 +07:00 [INF] Disabled permission view_dashboard for role admin
2025-10-03 08:38:17.918 +07:00 [INF] Disabled permission customize_dashboard for role admin
2025-10-03 08:38:17.922 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-10-03 08:38:18.001 +07:00 [INF] Updated permissions for role admin. Enabled permissions: 79
2025-10-03 08:38:18.003 +07:00 [INF] Enabled permissions: view_warehouse, edit_warehouse, manage_locations, view_cell_details, customize_warehouse, warehouse_config, use_warehouse_filters, drag_drop_position, transfer_goods, empty_cell, manage_clusters, create_cluster, view_production, manage_production, create_production_order, edit_production_order, delete_production_order, manage_machines, manage_production_schedule, view_employees, view_employee_performance, assign_staff, manage_permissions, manage_users, view_staff_info, view_reports, export_reports, view_activities, print_reports, schedule_reports, inventory_check, initiate_inventory_check, perform_inventory_check, verify_inventory_check, approve_inventory_adjustments, view_inventory_check_history, inventory_detail, view_alerts, manage_alerts, create_alert, delete_alert, manage_settings, view_products, edit_products, delete_products, import_products, export_products, track_products, manage_products, manage_inventory, view_maintenance_schedule, create_maintenance_task, assign_maintenance_task, mark_task_complete, maintenance, view_leave_requests, manage_leave_requests, view_notifications, manage_notifications, view_attendance, manage_attendance, view_import_export_orders, create_import_orders, create_export_orders, edit_import_export_orders, delete_import_export_orders, print_import_export_orders, view_suppliers, manage_suppliers, edit_suppliers, delete_suppliers, view_categories, manage_categories, edit_categories, delete_categories, view_users, edit_users, delete_users, export_dashboard
2025-10-03 08:38:18.018 +07:00 [INF] Updated permissions for role warehouse. Enabled permissions: 14
2025-10-03 08:38:18.020 +07:00 [INF] Enabled permissions: view_warehouse, view_cell_details, use_warehouse_filters, view_products, import_products, export_products, track_products, manage_inventory, view_dashboard, perform_inventory_check, view_inventory_check_history, view_leave_requests, create_leave_requests, view_notifications
2025-10-03 08:38:18.034 +07:00 [INF] Updated permissions for role team_leader. Enabled permissions: 27
2025-10-03 08:38:18.037 +07:00 [INF] Enabled permissions: view_warehouse, edit_warehouse, manage_locations, view_products, edit_products, manage_products, view_employees, view_employee_performance, view_reports, view_dashboard, view_production, manage_production, customize_warehouse, warehouse_config, view_maintenance_schedule, create_maintenance_task, initiate_inventory_check, approve_inventory_adjustments, view_alerts, view_leave_requests, create_leave_requests, approve_leave_requests, reject_leave_requests, view_notifications, create_notifications, edit_notifications, delete_notifications
2025-10-03 08:38:18.049 +07:00 [INF] Updated permissions for role sales. Enabled permissions: 9
2025-10-03 08:38:18.051 +07:00 [INF] Enabled permissions: view_products, view_warehouse, export_products, view_reports, view_dashboard, view_alerts, view_leave_requests, create_leave_requests, view_notifications
2025-10-03 08:48:47.800 +07:00 [INF] Disabled permission all for role admin
2025-10-03 08:48:47.804 +07:00 [INF] Disabled permission create_leave_requests for role admin
2025-10-03 08:48:47.807 +07:00 [INF] Disabled permission edit_leave_requests for role admin
2025-10-03 08:48:47.808 +07:00 [INF] Disabled permission approve_leave_requests for role admin
2025-10-03 08:48:47.809 +07:00 [INF] Disabled permission reject_leave_requests for role admin
2025-10-03 08:48:47.810 +07:00 [INF] Disabled permission delete_leave_requests for role admin
2025-10-03 08:48:47.811 +07:00 [INF] Disabled permission cancel_leave_requests for role admin
2025-10-03 08:48:47.812 +07:00 [INF] Disabled permission create_notifications for role admin
2025-10-03 08:48:47.813 +07:00 [INF] Disabled permission edit_notifications for role admin
2025-10-03 08:48:47.813 +07:00 [INF] Disabled permission delete_notifications for role admin
2025-10-03 08:48:47.814 +07:00 [INF] Disabled permission send_notifications for role admin
2025-10-03 08:48:47.815 +07:00 [INF] Disabled permission create_attendance for role admin
2025-10-03 08:48:47.816 +07:00 [INF] Disabled permission edit_attendance for role admin
2025-10-03 08:48:47.817 +07:00 [INF] Disabled permission delete_attendance for role admin
2025-10-03 08:48:47.818 +07:00 [INF] Disabled permission export_attendance for role admin
2025-10-03 08:48:47.819 +07:00 [INF] Disabled permission approve_attendance for role admin
2025-10-03 08:48:47.821 +07:00 [INF] Disabled permission reject_attendance for role admin
2025-10-03 08:48:47.822 +07:00 [INF] Disabled permission view_dashboard for role admin
2025-10-03 08:48:47.823 +07:00 [INF] Disabled permission customize_dashboard for role admin
2025-10-03 08:48:47.826 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-10-03 08:48:47.882 +07:00 [INF] Updated permissions for role admin. Enabled permissions: 79
2025-10-03 08:48:47.887 +07:00 [INF] Enabled permissions: view_warehouse, edit_warehouse, manage_locations, view_cell_details, customize_warehouse, warehouse_config, use_warehouse_filters, drag_drop_position, transfer_goods, empty_cell, manage_clusters, create_cluster, view_production, manage_production, create_production_order, edit_production_order, delete_production_order, manage_machines, manage_production_schedule, view_employees, view_employee_performance, assign_staff, manage_permissions, manage_users, view_staff_info, view_reports, export_reports, view_activities, print_reports, schedule_reports, inventory_check, initiate_inventory_check, perform_inventory_check, verify_inventory_check, approve_inventory_adjustments, view_inventory_check_history, inventory_detail, view_alerts, manage_alerts, create_alert, delete_alert, manage_settings, view_products, edit_products, delete_products, import_products, export_products, track_products, manage_products, manage_inventory, view_maintenance_schedule, create_maintenance_task, assign_maintenance_task, mark_task_complete, maintenance, view_leave_requests, manage_leave_requests, view_notifications, manage_notifications, view_attendance, manage_attendance, view_import_export_orders, create_import_orders, create_export_orders, edit_import_export_orders, delete_import_export_orders, print_import_export_orders, view_suppliers, manage_suppliers, edit_suppliers, delete_suppliers, view_categories, manage_categories, edit_categories, delete_categories, view_users, edit_users, delete_users, export_dashboard
2025-10-03 08:48:47.897 +07:00 [INF] Updated permissions for role warehouse. Enabled permissions: 14
2025-10-03 08:48:47.898 +07:00 [INF] Enabled permissions: view_warehouse, view_cell_details, use_warehouse_filters, view_products, import_products, export_products, track_products, manage_inventory, view_dashboard, perform_inventory_check, view_inventory_check_history, view_leave_requests, create_leave_requests, view_notifications
2025-10-03 08:48:47.905 +07:00 [INF] Updated permissions for role team_leader. Enabled permissions: 27
2025-10-03 08:48:47.906 +07:00 [INF] Enabled permissions: view_warehouse, edit_warehouse, manage_locations, view_products, edit_products, manage_products, view_employees, view_employee_performance, view_reports, view_dashboard, view_production, manage_production, customize_warehouse, warehouse_config, view_maintenance_schedule, create_maintenance_task, initiate_inventory_check, approve_inventory_adjustments, view_alerts, view_leave_requests, create_leave_requests, approve_leave_requests, reject_leave_requests, view_notifications, create_notifications, edit_notifications, delete_notifications
2025-10-03 08:48:47.913 +07:00 [INF] Updated permissions for role sales. Enabled permissions: 9
2025-10-03 08:48:47.915 +07:00 [INF] Enabled permissions: view_products, view_warehouse, export_products, view_reports, view_dashboard, view_alerts, view_leave_requests, create_leave_requests, view_notifications
2025-10-03 08:50:11.702 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-10-03 08:50:11.704 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-10-03 08:58:25.349 +07:00 [INF] Database migration completed successfully
2025-10-03 08:58:25.617 +07:00 [INF] Permissions data seeded successfully
2025-10-03 08:58:25.620 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 09:00:50.792 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 09:03:38.844 +07:00 [INF] Updated permissions for role admin. Enabled permissions: 98
2025-10-03 09:03:38.848 +07:00 [INF] Enabled permissions: all, view_warehouse, edit_warehouse, manage_locations, view_cell_details, customize_warehouse, warehouse_config, use_warehouse_filters, drag_drop_position, transfer_goods, empty_cell, manage_clusters, create_cluster, view_production, manage_production, create_production_order, edit_production_order, delete_production_order, manage_machines, manage_production_schedule, view_employees, view_employee_performance, assign_staff, manage_permissions, manage_users, view_staff_info, view_reports, export_reports, view_activities, print_reports, schedule_reports, inventory_check, initiate_inventory_check, perform_inventory_check, verify_inventory_check, approve_inventory_adjustments, view_inventory_check_history, inventory_detail, view_alerts, manage_alerts, create_alert, delete_alert, manage_settings, view_products, edit_products, delete_products, import_products, export_products, track_products, manage_products, manage_inventory, view_maintenance_schedule, create_maintenance_task, assign_maintenance_task, mark_task_complete, maintenance, view_leave_requests, manage_leave_requests, create_leave_requests, edit_leave_requests, approve_leave_requests, reject_leave_requests, delete_leave_requests, cancel_leave_requests, view_notifications, manage_notifications, create_notifications, edit_notifications, delete_notifications, send_notifications, view_attendance, manage_attendance, create_attendance, edit_attendance, delete_attendance, export_attendance, approve_attendance, reject_attendance, view_import_export_orders, create_import_orders, create_export_orders, edit_import_export_orders, delete_import_export_orders, print_import_export_orders, view_suppliers, manage_suppliers, edit_suppliers, delete_suppliers, view_categories, manage_categories, edit_categories, delete_categories, view_users, edit_users, delete_users, view_dashboard, customize_dashboard, export_dashboard
2025-10-03 09:03:38.858 +07:00 [INF] Updated permissions for role warehouse. Enabled permissions: 14
2025-10-03 09:03:38.859 +07:00 [INF] Enabled permissions: view_warehouse, view_cell_details, use_warehouse_filters, view_products, import_products, export_products, track_products, manage_inventory, view_dashboard, perform_inventory_check, view_inventory_check_history, view_leave_requests, create_leave_requests, view_notifications
2025-10-03 09:03:38.867 +07:00 [INF] Updated permissions for role team_leader. Enabled permissions: 27
2025-10-03 09:03:38.867 +07:00 [INF] Enabled permissions: view_warehouse, edit_warehouse, manage_locations, view_products, edit_products, manage_products, view_employees, view_employee_performance, view_reports, view_dashboard, view_production, manage_production, customize_warehouse, warehouse_config, view_maintenance_schedule, create_maintenance_task, initiate_inventory_check, approve_inventory_adjustments, view_alerts, view_leave_requests, create_leave_requests, approve_leave_requests, reject_leave_requests, view_notifications, create_notifications, edit_notifications, delete_notifications
2025-10-03 09:03:38.872 +07:00 [INF] Updated permissions for role sales. Enabled permissions: 9
2025-10-03 09:03:38.873 +07:00 [INF] Enabled permissions: view_products, view_warehouse, export_products, view_reports, view_dashboard, view_alerts, view_leave_requests, create_leave_requests, view_notifications
2025-10-03 09:13:31.615 +07:00 [INF] Database migration completed successfully
2025-10-03 09:13:31.804 +07:00 [INF] Permissions data seeded successfully
2025-10-03 09:13:31.808 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 09:13:42.785 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 09:13:51.613 +07:00 [INF] Updated permissions for role admin. Enabled permissions: 98
2025-10-03 09:13:51.616 +07:00 [INF] Enabled permissions: all, view_warehouse, edit_warehouse, manage_locations, view_cell_details, customize_warehouse, warehouse_config, use_warehouse_filters, drag_drop_position, transfer_goods, empty_cell, manage_clusters, create_cluster, view_production, manage_production, create_production_order, edit_production_order, delete_production_order, manage_machines, manage_production_schedule, view_employees, view_employee_performance, assign_staff, manage_permissions, manage_users, view_staff_info, view_reports, export_reports, view_activities, print_reports, schedule_reports, inventory_check, initiate_inventory_check, perform_inventory_check, verify_inventory_check, approve_inventory_adjustments, view_inventory_check_history, inventory_detail, view_alerts, manage_alerts, create_alert, delete_alert, manage_settings, view_products, edit_products, delete_products, import_products, export_products, track_products, manage_products, manage_inventory, view_maintenance_schedule, create_maintenance_task, assign_maintenance_task, mark_task_complete, maintenance, view_leave_requests, manage_leave_requests, create_leave_requests, edit_leave_requests, approve_leave_requests, reject_leave_requests, delete_leave_requests, cancel_leave_requests, view_notifications, manage_notifications, create_notifications, edit_notifications, delete_notifications, send_notifications, view_attendance, manage_attendance, create_attendance, edit_attendance, delete_attendance, export_attendance, approve_attendance, reject_attendance, view_import_export_orders, create_import_orders, create_export_orders, edit_import_export_orders, delete_import_export_orders, print_import_export_orders, view_suppliers, manage_suppliers, edit_suppliers, delete_suppliers, view_categories, manage_categories, edit_categories, delete_categories, view_users, edit_users, delete_users, view_dashboard, customize_dashboard, export_dashboard
2025-10-03 09:13:51.629 +07:00 [INF] Updated permissions for role warehouse. Enabled permissions: 14
2025-10-03 09:13:51.630 +07:00 [INF] Enabled permissions: view_warehouse, view_cell_details, use_warehouse_filters, view_products, import_products, export_products, track_products, manage_inventory, view_dashboard, perform_inventory_check, view_inventory_check_history, view_leave_requests, create_leave_requests, view_notifications
2025-10-03 09:13:51.640 +07:00 [INF] Updated permissions for role team_leader. Enabled permissions: 27
2025-10-03 09:13:51.640 +07:00 [INF] Enabled permissions: view_warehouse, edit_warehouse, manage_locations, view_products, edit_products, manage_products, view_employees, view_employee_performance, view_reports, view_dashboard, view_production, manage_production, customize_warehouse, warehouse_config, view_maintenance_schedule, create_maintenance_task, initiate_inventory_check, approve_inventory_adjustments, view_alerts, view_leave_requests, create_leave_requests, approve_leave_requests, reject_leave_requests, view_notifications, create_notifications, edit_notifications, delete_notifications
2025-10-03 09:13:51.647 +07:00 [INF] Updated permissions for role sales. Enabled permissions: 9
2025-10-03 09:13:51.647 +07:00 [INF] Enabled permissions: view_products, view_warehouse, export_products, view_reports, view_dashboard, view_alerts, view_leave_requests, create_leave_requests, view_notifications
2025-10-03 09:19:00.814 +07:00 [INF] Updated permissions for role admin. Enabled permissions: 98
2025-10-03 09:19:00.815 +07:00 [INF] Enabled permissions: all, view_warehouse, edit_warehouse, manage_locations, view_cell_details, customize_warehouse, warehouse_config, use_warehouse_filters, drag_drop_position, transfer_goods, empty_cell, manage_clusters, create_cluster, view_production, manage_production, create_production_order, edit_production_order, delete_production_order, manage_machines, manage_production_schedule, view_employees, view_employee_performance, assign_staff, manage_permissions, manage_users, view_staff_info, view_reports, export_reports, view_activities, print_reports, schedule_reports, inventory_check, initiate_inventory_check, perform_inventory_check, verify_inventory_check, approve_inventory_adjustments, view_inventory_check_history, inventory_detail, view_alerts, manage_alerts, create_alert, delete_alert, manage_settings, view_products, edit_products, delete_products, import_products, export_products, track_products, manage_products, manage_inventory, view_maintenance_schedule, create_maintenance_task, assign_maintenance_task, mark_task_complete, maintenance, view_leave_requests, manage_leave_requests, create_leave_requests, edit_leave_requests, approve_leave_requests, reject_leave_requests, delete_leave_requests, cancel_leave_requests, view_notifications, manage_notifications, create_notifications, edit_notifications, delete_notifications, send_notifications, view_attendance, manage_attendance, create_attendance, edit_attendance, delete_attendance, export_attendance, approve_attendance, reject_attendance, view_import_export_orders, create_import_orders, create_export_orders, edit_import_export_orders, delete_import_export_orders, print_import_export_orders, view_suppliers, manage_suppliers, edit_suppliers, delete_suppliers, view_categories, manage_categories, edit_categories, delete_categories, view_users, edit_users, delete_users, view_dashboard, customize_dashboard, export_dashboard
2025-10-03 09:19:00.821 +07:00 [INF] Updated permissions for role warehouse. Enabled permissions: 14
2025-10-03 09:19:00.821 +07:00 [INF] Enabled permissions: view_warehouse, view_cell_details, use_warehouse_filters, view_products, import_products, export_products, track_products, manage_inventory, view_dashboard, perform_inventory_check, view_inventory_check_history, view_leave_requests, create_leave_requests, view_notifications
2025-10-03 09:19:00.826 +07:00 [INF] Updated permissions for role team_leader. Enabled permissions: 27
2025-10-03 09:19:00.827 +07:00 [INF] Enabled permissions: view_warehouse, edit_warehouse, manage_locations, view_products, edit_products, manage_products, view_employees, view_employee_performance, view_reports, view_dashboard, view_production, manage_production, customize_warehouse, warehouse_config, view_maintenance_schedule, create_maintenance_task, initiate_inventory_check, approve_inventory_adjustments, view_alerts, view_leave_requests, create_leave_requests, approve_leave_requests, reject_leave_requests, view_notifications, create_notifications, edit_notifications, delete_notifications
2025-10-03 09:19:00.831 +07:00 [INF] Updated permissions for role sales. Enabled permissions: 9
2025-10-03 09:19:00.832 +07:00 [INF] Enabled permissions: view_products, view_warehouse, export_products, view_reports, view_dashboard, view_alerts, view_leave_requests, create_leave_requests, view_notifications
2025-10-03 09:24:12.363 +07:00 [INF] Updated permissions for role admin. Enabled permissions: 98
2025-10-03 09:24:12.364 +07:00 [INF] Enabled permissions: all, view_warehouse, edit_warehouse, manage_locations, view_cell_details, customize_warehouse, warehouse_config, use_warehouse_filters, drag_drop_position, transfer_goods, empty_cell, manage_clusters, create_cluster, view_production, manage_production, create_production_order, edit_production_order, delete_production_order, manage_machines, manage_production_schedule, view_employees, view_employee_performance, assign_staff, manage_permissions, manage_users, view_staff_info, view_reports, export_reports, view_activities, print_reports, schedule_reports, inventory_check, initiate_inventory_check, perform_inventory_check, verify_inventory_check, approve_inventory_adjustments, view_inventory_check_history, inventory_detail, view_alerts, manage_alerts, create_alert, delete_alert, manage_settings, view_products, edit_products, delete_products, import_products, export_products, track_products, manage_products, manage_inventory, view_maintenance_schedule, create_maintenance_task, assign_maintenance_task, mark_task_complete, maintenance, view_leave_requests, manage_leave_requests, create_leave_requests, edit_leave_requests, approve_leave_requests, reject_leave_requests, delete_leave_requests, cancel_leave_requests, view_notifications, manage_notifications, create_notifications, edit_notifications, delete_notifications, send_notifications, view_attendance, manage_attendance, create_attendance, edit_attendance, delete_attendance, export_attendance, approve_attendance, reject_attendance, view_import_export_orders, create_import_orders, create_export_orders, edit_import_export_orders, delete_import_export_orders, print_import_export_orders, view_suppliers, manage_suppliers, edit_suppliers, delete_suppliers, view_categories, manage_categories, edit_categories, delete_categories, view_users, edit_users, delete_users, view_dashboard, customize_dashboard, export_dashboard
2025-10-03 09:24:12.371 +07:00 [INF] Updated permissions for role warehouse. Enabled permissions: 14
2025-10-03 09:24:12.371 +07:00 [INF] Enabled permissions: view_warehouse, view_cell_details, use_warehouse_filters, view_products, import_products, export_products, track_products, manage_inventory, view_dashboard, perform_inventory_check, view_inventory_check_history, view_leave_requests, create_leave_requests, view_notifications
2025-10-03 09:24:12.376 +07:00 [INF] Updated permissions for role team_leader. Enabled permissions: 27
2025-10-03 09:24:12.377 +07:00 [INF] Enabled permissions: view_warehouse, edit_warehouse, manage_locations, view_products, edit_products, manage_products, view_employees, view_employee_performance, view_reports, view_dashboard, view_production, manage_production, customize_warehouse, warehouse_config, view_maintenance_schedule, create_maintenance_task, initiate_inventory_check, approve_inventory_adjustments, view_alerts, view_leave_requests, create_leave_requests, approve_leave_requests, reject_leave_requests, view_notifications, create_notifications, edit_notifications, delete_notifications
2025-10-03 09:24:12.384 +07:00 [INF] Updated permissions for role sales. Enabled permissions: 9
2025-10-03 09:24:12.385 +07:00 [INF] Enabled permissions: view_products, view_warehouse, export_products, view_reports, view_dashboard, view_alerts, view_leave_requests, create_leave_requests, view_notifications
2025-10-03 09:24:54.099 +07:00 [INF] Updated permissions for role admin. Enabled permissions: 98
2025-10-03 09:24:54.102 +07:00 [INF] Enabled permissions: all, view_warehouse, edit_warehouse, manage_locations, view_cell_details, customize_warehouse, warehouse_config, use_warehouse_filters, drag_drop_position, transfer_goods, empty_cell, manage_clusters, create_cluster, view_production, manage_production, create_production_order, edit_production_order, delete_production_order, manage_machines, manage_production_schedule, view_employees, view_employee_performance, assign_staff, manage_permissions, manage_users, view_staff_info, view_reports, export_reports, view_activities, print_reports, schedule_reports, inventory_check, initiate_inventory_check, perform_inventory_check, verify_inventory_check, approve_inventory_adjustments, view_inventory_check_history, inventory_detail, view_alerts, manage_alerts, create_alert, delete_alert, manage_settings, view_products, edit_products, delete_products, import_products, export_products, track_products, manage_products, manage_inventory, view_maintenance_schedule, create_maintenance_task, assign_maintenance_task, mark_task_complete, maintenance, view_leave_requests, manage_leave_requests, create_leave_requests, edit_leave_requests, approve_leave_requests, reject_leave_requests, delete_leave_requests, cancel_leave_requests, view_notifications, manage_notifications, create_notifications, edit_notifications, delete_notifications, send_notifications, view_attendance, manage_attendance, create_attendance, edit_attendance, delete_attendance, export_attendance, approve_attendance, reject_attendance, view_import_export_orders, create_import_orders, create_export_orders, edit_import_export_orders, delete_import_export_orders, print_import_export_orders, view_suppliers, manage_suppliers, edit_suppliers, delete_suppliers, view_categories, manage_categories, edit_categories, delete_categories, view_users, edit_users, delete_users, view_dashboard, customize_dashboard, export_dashboard
2025-10-03 09:24:54.108 +07:00 [INF] Updated permissions for role warehouse. Enabled permissions: 14
2025-10-03 09:24:54.108 +07:00 [INF] Enabled permissions: view_warehouse, view_cell_details, use_warehouse_filters, view_products, import_products, export_products, track_products, manage_inventory, view_dashboard, perform_inventory_check, view_inventory_check_history, view_leave_requests, create_leave_requests, view_notifications
2025-10-03 09:24:54.113 +07:00 [INF] Updated permissions for role team_leader. Enabled permissions: 27
2025-10-03 09:24:54.114 +07:00 [INF] Enabled permissions: view_warehouse, edit_warehouse, manage_locations, view_products, edit_products, manage_products, view_employees, view_employee_performance, view_reports, view_dashboard, view_production, manage_production, customize_warehouse, warehouse_config, view_maintenance_schedule, create_maintenance_task, initiate_inventory_check, approve_inventory_adjustments, view_alerts, view_leave_requests, create_leave_requests, approve_leave_requests, reject_leave_requests, view_notifications, create_notifications, edit_notifications, delete_notifications
2025-10-03 09:24:54.119 +07:00 [INF] Updated permissions for role sales. Enabled permissions: 9
2025-10-03 09:24:54.120 +07:00 [INF] Enabled permissions: view_products, view_warehouse, export_products, view_reports, view_dashboard, view_alerts, view_leave_requests, create_leave_requests, view_notifications
2025-10-03 09:34:16.036 +07:00 [INF] Updated permissions for role admin. Enabled permissions: 98
2025-10-03 09:34:16.037 +07:00 [INF] Enabled permissions: all, view_warehouse, edit_warehouse, manage_locations, view_cell_details, customize_warehouse, warehouse_config, use_warehouse_filters, drag_drop_position, transfer_goods, empty_cell, manage_clusters, create_cluster, view_production, manage_production, create_production_order, edit_production_order, delete_production_order, manage_machines, manage_production_schedule, view_employees, view_employee_performance, assign_staff, manage_permissions, manage_users, view_staff_info, view_reports, export_reports, view_activities, print_reports, schedule_reports, inventory_check, initiate_inventory_check, perform_inventory_check, verify_inventory_check, approve_inventory_adjustments, view_inventory_check_history, inventory_detail, view_alerts, manage_alerts, create_alert, delete_alert, manage_settings, view_products, edit_products, delete_products, import_products, export_products, track_products, manage_products, manage_inventory, view_maintenance_schedule, create_maintenance_task, assign_maintenance_task, mark_task_complete, maintenance, view_leave_requests, manage_leave_requests, create_leave_requests, edit_leave_requests, approve_leave_requests, reject_leave_requests, delete_leave_requests, cancel_leave_requests, view_notifications, manage_notifications, create_notifications, edit_notifications, delete_notifications, send_notifications, view_attendance, manage_attendance, create_attendance, edit_attendance, delete_attendance, export_attendance, approve_attendance, reject_attendance, view_import_export_orders, create_import_orders, create_export_orders, edit_import_export_orders, delete_import_export_orders, print_import_export_orders, view_suppliers, manage_suppliers, edit_suppliers, delete_suppliers, view_categories, manage_categories, edit_categories, delete_categories, view_users, edit_users, delete_users, view_dashboard, customize_dashboard, export_dashboard
2025-10-03 09:34:16.045 +07:00 [INF] Updated permissions for role warehouse. Enabled permissions: 14
2025-10-03 09:34:16.046 +07:00 [INF] Enabled permissions: view_warehouse, view_cell_details, use_warehouse_filters, view_products, import_products, export_products, track_products, manage_inventory, view_dashboard, perform_inventory_check, view_inventory_check_history, view_leave_requests, create_leave_requests, view_notifications
2025-10-03 09:34:16.053 +07:00 [INF] Updated permissions for role team_leader. Enabled permissions: 27
2025-10-03 09:34:16.054 +07:00 [INF] Enabled permissions: view_warehouse, edit_warehouse, manage_locations, view_products, edit_products, manage_products, view_employees, view_employee_performance, view_reports, view_dashboard, view_production, manage_production, customize_warehouse, warehouse_config, view_maintenance_schedule, create_maintenance_task, initiate_inventory_check, approve_inventory_adjustments, view_alerts, view_leave_requests, create_leave_requests, approve_leave_requests, reject_leave_requests, view_notifications, create_notifications, edit_notifications, delete_notifications
2025-10-03 09:34:16.062 +07:00 [INF] Updated permissions for role sales. Enabled permissions: 9
2025-10-03 09:34:16.063 +07:00 [INF] Enabled permissions: view_products, view_warehouse, export_products, view_reports, view_dashboard, view_alerts, view_leave_requests, create_leave_requests, view_notifications
2025-10-03 10:30:28.848 +07:00 [INF] Updated permissions for role admin. Enabled permissions: 98
2025-10-03 10:30:28.849 +07:00 [INF] Enabled permissions: all, view_warehouse, edit_warehouse, manage_locations, view_cell_details, customize_warehouse, warehouse_config, use_warehouse_filters, drag_drop_position, transfer_goods, empty_cell, manage_clusters, create_cluster, view_production, manage_production, create_production_order, edit_production_order, delete_production_order, manage_machines, manage_production_schedule, view_employees, view_employee_performance, assign_staff, manage_permissions, manage_users, view_staff_info, view_reports, export_reports, view_activities, print_reports, schedule_reports, inventory_check, initiate_inventory_check, perform_inventory_check, verify_inventory_check, approve_inventory_adjustments, view_inventory_check_history, inventory_detail, view_alerts, manage_alerts, create_alert, delete_alert, manage_settings, view_products, edit_products, delete_products, import_products, export_products, track_products, manage_products, manage_inventory, view_maintenance_schedule, create_maintenance_task, assign_maintenance_task, mark_task_complete, maintenance, view_leave_requests, manage_leave_requests, create_leave_requests, edit_leave_requests, approve_leave_requests, reject_leave_requests, delete_leave_requests, cancel_leave_requests, view_notifications, manage_notifications, create_notifications, edit_notifications, delete_notifications, send_notifications, view_attendance, manage_attendance, create_attendance, edit_attendance, delete_attendance, export_attendance, approve_attendance, reject_attendance, view_import_export_orders, create_import_orders, create_export_orders, edit_import_export_orders, delete_import_export_orders, print_import_export_orders, view_suppliers, manage_suppliers, edit_suppliers, delete_suppliers, view_categories, manage_categories, edit_categories, delete_categories, view_users, edit_users, delete_users, view_dashboard, customize_dashboard, export_dashboard
2025-10-03 10:30:45.535 +07:00 [INF] Updated permissions for role admin. Enabled permissions: 98
2025-10-03 10:30:45.536 +07:00 [INF] Enabled permissions: all, view_warehouse, edit_warehouse, manage_locations, view_cell_details, customize_warehouse, warehouse_config, use_warehouse_filters, drag_drop_position, transfer_goods, empty_cell, manage_clusters, create_cluster, view_production, manage_production, create_production_order, edit_production_order, delete_production_order, manage_machines, manage_production_schedule, view_employees, view_employee_performance, assign_staff, manage_permissions, manage_users, view_staff_info, view_reports, export_reports, view_activities, print_reports, schedule_reports, inventory_check, initiate_inventory_check, perform_inventory_check, verify_inventory_check, approve_inventory_adjustments, view_inventory_check_history, inventory_detail, view_alerts, manage_alerts, create_alert, delete_alert, manage_settings, view_products, edit_products, delete_products, import_products, export_products, track_products, manage_products, manage_inventory, view_maintenance_schedule, create_maintenance_task, assign_maintenance_task, mark_task_complete, maintenance, view_leave_requests, manage_leave_requests, create_leave_requests, edit_leave_requests, approve_leave_requests, reject_leave_requests, delete_leave_requests, cancel_leave_requests, view_notifications, manage_notifications, create_notifications, edit_notifications, delete_notifications, send_notifications, view_attendance, manage_attendance, create_attendance, edit_attendance, delete_attendance, export_attendance, approve_attendance, reject_attendance, view_import_export_orders, create_import_orders, create_export_orders, edit_import_export_orders, delete_import_export_orders, print_import_export_orders, view_suppliers, manage_suppliers, edit_suppliers, delete_suppliers, view_categories, manage_categories, edit_categories, delete_categories, view_users, edit_users, delete_users, view_dashboard, customize_dashboard, export_dashboard
2025-10-03 10:30:46.575 +07:00 [INF] Updated permissions for role admin. Enabled permissions: 98
2025-10-03 10:30:46.576 +07:00 [INF] Enabled permissions: all, view_warehouse, edit_warehouse, manage_locations, view_cell_details, customize_warehouse, warehouse_config, use_warehouse_filters, drag_drop_position, transfer_goods, empty_cell, manage_clusters, create_cluster, view_production, manage_production, create_production_order, edit_production_order, delete_production_order, manage_machines, manage_production_schedule, view_employees, view_employee_performance, assign_staff, manage_permissions, manage_users, view_staff_info, view_reports, export_reports, view_activities, print_reports, schedule_reports, inventory_check, initiate_inventory_check, perform_inventory_check, verify_inventory_check, approve_inventory_adjustments, view_inventory_check_history, inventory_detail, view_alerts, manage_alerts, create_alert, delete_alert, manage_settings, view_products, edit_products, delete_products, import_products, export_products, track_products, manage_products, manage_inventory, view_maintenance_schedule, create_maintenance_task, assign_maintenance_task, mark_task_complete, maintenance, view_leave_requests, manage_leave_requests, create_leave_requests, edit_leave_requests, approve_leave_requests, reject_leave_requests, delete_leave_requests, cancel_leave_requests, view_notifications, manage_notifications, create_notifications, edit_notifications, delete_notifications, send_notifications, view_attendance, manage_attendance, create_attendance, edit_attendance, delete_attendance, export_attendance, approve_attendance, reject_attendance, view_import_export_orders, create_import_orders, create_export_orders, edit_import_export_orders, delete_import_export_orders, print_import_export_orders, view_suppliers, manage_suppliers, edit_suppliers, delete_suppliers, view_categories, manage_categories, edit_categories, delete_categories, view_users, edit_users, delete_users, view_dashboard, customize_dashboard, export_dashboard
2025-10-03 10:33:14.452 +07:00 [INF] Toggled permission view_dashboard for role admin to disabled
2025-10-03 10:33:24.169 +07:00 [INF] Toggled permission view_dashboard for role admin to disabled
2025-10-03 10:33:30.335 +07:00 [INF] Toggled permission view_dashboard for role admin to disabled
2025-10-03 11:12:22.510 +07:00 [INF] Toggled permission view_dashboard for role admin to disabled
2025-10-03 11:12:45.651 +07:00 [INF] Toggled permission view_dashboard for role admin to disabled
2025-10-03 11:14:46.984 +07:00 [INF] Database migration completed successfully
2025-10-03 11:14:47.188 +07:00 [INF] Permissions data seeded successfully
2025-10-03 11:14:47.192 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 11:14:53.560 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 11:15:01.304 +07:00 [INF] Permission view_dashboard for role admin updated to enabled in database
2025-10-03 11:15:01.308 +07:00 [INF] Toggled permission view_dashboard for role admin to enabled
2025-10-03 11:15:27.687 +07:00 [INF] Permission view_dashboard for role admin updated to disabled in database
2025-10-03 11:15:27.688 +07:00 [INF] Toggled permission view_dashboard for role admin to disabled
2025-10-03 11:15:32.516 +07:00 [INF] Permission view_dashboard for role admin updated to enabled in database
2025-10-03 11:15:32.517 +07:00 [INF] Toggled permission view_dashboard for role admin to enabled
2025-10-03 11:19:12.596 +07:00 [INF] Permission view_dashboard for role admin updated to disabled in database
2025-10-03 11:19:12.597 +07:00 [INF] Toggled permission view_dashboard for role admin to disabled
2025-10-03 11:19:18.753 +07:00 [INF] Permission view_dashboard for role admin updated to enabled in database
2025-10-03 11:19:18.754 +07:00 [INF] Toggled permission view_dashboard for role admin to enabled
2025-10-03 11:20:00.712 +07:00 [INF] Database migration completed successfully
2025-10-03 11:20:00.896 +07:00 [INF] Permissions data seeded successfully
2025-10-03 11:20:00.900 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 11:20:08.453 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 11:20:14.255 +07:00 [INF] Permission view_dashboard for role admin updated to disabled in database
2025-10-03 11:20:14.258 +07:00 [INF] Toggled permission view_dashboard for role admin to disabled
2025-10-03 11:20:19.714 +07:00 [INF] Permission view_dashboard for role admin updated to enabled in database
2025-10-03 11:20:19.714 +07:00 [INF] Toggled permission view_dashboard for role admin to enabled
2025-10-03 11:38:27.174 +07:00 [INF] Permission view_dashboard for role admin updated to disabled in database
2025-10-03 11:38:27.175 +07:00 [INF] Toggled permission view_dashboard for role admin to disabled
2025-10-03 11:38:33.330 +07:00 [INF] Permission view_dashboard for role admin updated to enabled in database
2025-10-03 11:38:33.331 +07:00 [INF] Toggled permission view_dashboard for role admin to enabled
2025-10-03 12:04:13.999 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-10-03 12:04:14.000 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-10-03 12:04:18.656 +07:00 [INF] Permission view_dashboard for role admin updated to disabled in database
2025-10-03 12:04:18.660 +07:00 [INF] Toggled permission view_dashboard for role admin to disabled
2025-10-03 12:04:26.369 +07:00 [INF] Permission view_dashboard for role admin updated to enabled in database
2025-10-03 12:04:26.372 +07:00 [INF] Toggled permission view_dashboard for role admin to enabled
2025-10-03 13:14:20.738 +07:00 [INF] Database migration completed successfully
2025-10-03 13:14:21.113 +07:00 [INF] Permissions data seeded successfully
2025-10-03 13:14:21.123 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 13:14:29.697 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 13:14:42.935 +07:00 [ERR] Error getting users for role admin
System.InvalidOperationException: The LINQ expression 'DbSet<User>()
    .Where(u => u.Role.ToString() == __role_0)' could not be translated. Additional information: Translation of method 'object.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass12_0`1.<ExecuteAsync>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at FertilizerWarehouseAPI.Controllers.PermissionsController.GetUsersByRole(String role) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Controllers\PermissionsController.cs:line 166
2025-10-03 13:17:47.577 +07:00 [INF] Database migration completed successfully
2025-10-03 13:17:47.843 +07:00 [INF] Permissions data seeded successfully
2025-10-03 13:17:47.847 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 13:18:41.377 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 13:22:38.789 +07:00 [INF] Database migration completed successfully
2025-10-03 13:22:39.086 +07:00 [INF] Permissions data seeded successfully
2025-10-03 13:22:39.093 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 13:22:45.764 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 13:25:42.545 +07:00 [INF] Permission view_dashboard for role warehouse updated to disabled in database
2025-10-03 13:25:42.552 +07:00 [INF] Toggled permission view_dashboard for role warehouse to disabled
2025-10-03 13:27:16.160 +07:00 [INF] Permission view_dashboard for role teamleader updated to enabled in database
2025-10-03 13:27:16.164 +07:00 [INF] Toggled permission view_dashboard for role teamleader to enabled
2025-10-03 13:27:21.027 +07:00 [INF] Permission view_dashboard for role teamleader updated to disabled in database
2025-10-03 13:27:21.030 +07:00 [INF] Toggled permission view_dashboard for role teamleader to disabled
2025-10-03 13:38:22.748 +07:00 [INF] Database migration completed successfully
2025-10-03 13:38:23.055 +07:00 [INF] Permissions data seeded successfully
2025-10-03 13:38:23.061 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 13:38:26.140 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 13:43:53.472 +07:00 [INF] Database migration completed successfully
2025-10-03 13:43:53.835 +07:00 [INF] Permissions data seeded successfully
2025-10-03 13:43:53.845 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 13:43:54.252 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 13:49:57.472 +07:00 [INF] Database migration completed successfully
2025-10-03 13:49:57.740 +07:00 [INF] Permissions data seeded successfully
2025-10-03 13:49:57.743 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 13:50:03.509 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 13:57:46.825 +07:00 [INF] Database migration completed successfully
2025-10-03 13:57:47.317 +07:00 [INF] Permissions data seeded successfully
2025-10-03 13:57:47.322 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 13:58:03.728 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 14:31:09.540 +07:00 [INF] Database migration completed successfully
2025-10-03 14:31:09.993 +07:00 [INF] Permissions data seeded successfully
2025-10-03 14:31:09.999 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 14:31:14.173 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 14:34:14.646 +07:00 [INF] Database migration completed successfully
2025-10-03 14:34:14.853 +07:00 [INF] Permissions data seeded successfully
2025-10-03 14:34:14.857 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 14:35:18.063 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 14:37:19.261 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'FertilizerWarehouseAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The UPDATE statement conflicted with the FOREIGN KEY constraint "FK_Users_Companies_CompanyId". The conflict occurred in database "FertilizerWarehouseDB", table "dbo.Companies", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:e93bfd7a-c301-4ce8-a6fa-8212ad795f19
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The UPDATE statement conflicted with the FOREIGN KEY constraint "FK_Users_Companies_CompanyId". The conflict occurred in database "FertilizerWarehouseDB", table "dbo.Companies", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:e93bfd7a-c301-4ce8-a6fa-8212ad795f19
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-10-03 14:39:23.946 +07:00 [INF] Database migration completed successfully
2025-10-03 14:39:24.154 +07:00 [INF] Permissions data seeded successfully
2025-10-03 14:39:24.159 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 14:39:37.448 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 14:47:58.893 +07:00 [INF] Database migration completed successfully
2025-10-03 14:47:59.207 +07:00 [INF] Permissions data seeded successfully
2025-10-03 14:47:59.212 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 14:48:03.454 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 14:51:33.598 +07:00 [INF] Database migration completed successfully
2025-10-03 14:51:33.886 +07:00 [INF] Permissions data seeded successfully
2025-10-03 14:51:33.893 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 14:51:51.416 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 14:59:56.691 +07:00 [INF] Database migration completed successfully
2025-10-03 14:59:56.927 +07:00 [INF] Permissions data seeded successfully
2025-10-03 14:59:56.932 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 15:00:18.393 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 15:04:44.659 +07:00 [INF] Database migration completed successfully
2025-10-03 15:04:44.845 +07:00 [INF] Permissions data seeded successfully
2025-10-03 15:04:44.849 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 15:04:49.564 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 15:18:25.495 +07:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [LoginHistories] AS [l]
WHERE [l].[UserId] = @__userId_0 AND [l].[Action] = N'FailedLogin' AND [l].[Timestamp] > DATEADD(minute, CAST(15.0E0 AS int), GETUTCDATE())
2025-10-03 15:18:25.516 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'FertilizerWarehouseAPI.Data.ApplicationDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:61cefdf2-86bf-4b9b-aada-da2a3c6cac18
Error Number:208,State:1,Class:16
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:61cefdf2-86bf-4b9b-aada-da2a3c6cac18
Error Number:208,State:1,Class:16
2025-10-03 15:18:25.521 +07:00 [ERR] Error during login for user 2180607167
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.ShouldLockAccountAsync(Int32 userId) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 438
   at FertilizerWarehouseAPI.Controllers.AuthController.Login(LoginDto loginDto) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Controllers\AuthController.cs:line 81
ClientConnectionId:61cefdf2-86bf-4b9b-aada-da2a3c6cac18
Error Number:208,State:1,Class:16
2025-10-03 15:18:42.348 +07:00 [ERR] Failed executing DbCommand (2ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [LoginHistories] AS [l]
WHERE [l].[UserId] = @__userId_0 AND [l].[Action] = N'FailedLogin' AND [l].[Timestamp] > DATEADD(minute, CAST(15.0E0 AS int), GETUTCDATE())
2025-10-03 15:18:42.351 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'FertilizerWarehouseAPI.Data.ApplicationDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:61cefdf2-86bf-4b9b-aada-da2a3c6cac18
Error Number:208,State:1,Class:16
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:61cefdf2-86bf-4b9b-aada-da2a3c6cac18
Error Number:208,State:1,Class:16
2025-10-03 15:18:42.356 +07:00 [ERR] Error during login for user 2180607167
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.ShouldLockAccountAsync(Int32 userId) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 438
   at FertilizerWarehouseAPI.Controllers.AuthController.Login(LoginDto loginDto) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Controllers\AuthController.cs:line 81
ClientConnectionId:61cefdf2-86bf-4b9b-aada-da2a3c6cac18
Error Number:208,State:1,Class:16
2025-10-03 15:19:34.355 +07:00 [ERR] Failed executing DbCommand (3ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [LoginHistories] AS [l]
WHERE [l].[UserId] = @__userId_0 AND [l].[Action] = N'FailedLogin' AND [l].[Timestamp] > DATEADD(minute, CAST(15.0E0 AS int), GETUTCDATE())
2025-10-03 15:19:34.358 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'FertilizerWarehouseAPI.Data.ApplicationDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:61cefdf2-86bf-4b9b-aada-da2a3c6cac18
Error Number:208,State:1,Class:16
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:61cefdf2-86bf-4b9b-aada-da2a3c6cac18
Error Number:208,State:1,Class:16
2025-10-03 15:19:34.364 +07:00 [ERR] Error during login for user admin
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.ShouldLockAccountAsync(Int32 userId) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 438
   at FertilizerWarehouseAPI.Controllers.AuthController.Login(LoginDto loginDto) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Controllers\AuthController.cs:line 81
ClientConnectionId:61cefdf2-86bf-4b9b-aada-da2a3c6cac18
Error Number:208,State:1,Class:16
2025-10-03 15:19:47.755 +07:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [LoginHistories] AS [l]
WHERE [l].[UserId] = @__userId_0 AND [l].[Action] = N'FailedLogin' AND [l].[Timestamp] > DATEADD(minute, CAST(15.0E0 AS int), GETUTCDATE())
2025-10-03 15:19:47.759 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'FertilizerWarehouseAPI.Data.ApplicationDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:61cefdf2-86bf-4b9b-aada-da2a3c6cac18
Error Number:208,State:1,Class:16
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:61cefdf2-86bf-4b9b-aada-da2a3c6cac18
Error Number:208,State:1,Class:16
2025-10-03 15:19:47.768 +07:00 [ERR] Error during login for user admin
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.ShouldLockAccountAsync(Int32 userId) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 438
   at FertilizerWarehouseAPI.Controllers.AuthController.Login(LoginDto loginDto) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Controllers\AuthController.cs:line 81
ClientConnectionId:61cefdf2-86bf-4b9b-aada-da2a3c6cac18
Error Number:208,State:1,Class:16
2025-10-03 15:21:20.302 +07:00 [INF] Database migration completed successfully
2025-10-03 15:21:20.517 +07:00 [INF] Permissions data seeded successfully
2025-10-03 15:21:20.521 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 15:21:28.890 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 15:21:30.205 +07:00 [ERR] Failed executing DbCommand (15ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [LoginHistories] AS [l]
WHERE [l].[UserId] = @__userId_0 AND [l].[Action] = N'FailedLogin' AND [l].[Timestamp] > DATEADD(minute, CAST(15.0E0 AS int), GETUTCDATE())
2025-10-03 15:21:30.227 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'FertilizerWarehouseAPI.Data.ApplicationDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__209_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:6bef7a38-cda0-41be-b42b-062c6de85f48
Error Number:208,State:1,Class:16
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__209_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:6bef7a38-cda0-41be-b42b-062c6de85f48
Error Number:208,State:1,Class:16
2025-10-03 15:21:30.237 +07:00 [ERR] Error during login for user admin
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__209_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.ShouldLockAccountAsync(Int32 userId) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 438
   at FertilizerWarehouseAPI.Controllers.AuthController.Login(LoginDto loginDto) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Controllers\AuthController.cs:line 81
ClientConnectionId:6bef7a38-cda0-41be-b42b-062c6de85f48
Error Number:208,State:1,Class:16
2025-10-03 15:21:44.282 +07:00 [ERR] Failed executing DbCommand (3ms) [Parameters=[@__userId_0='?' (DbType = Int32), @__deviceFingerprint_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [TrustedDevices] AS [t]
        WHERE [t].[UserId] = @__userId_0 AND [t].[DeviceFingerprint] = @__deviceFingerprint_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-03 15:21:44.285 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'FertilizerWarehouseAPI.Data.ApplicationDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'TrustedDevices'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__209_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:6bef7a38-cda0-41be-b42b-062c6de85f48
Error Number:208,State:1,Class:16
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'TrustedDevices'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__209_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:6bef7a38-cda0-41be-b42b-062c6de85f48
Error Number:208,State:1,Class:16
2025-10-03 15:21:44.290 +07:00 [ERR] Error logging login for user 3
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'TrustedDevices'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__209_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.IsNewDeviceAsync(Int32 userId, String deviceFingerprint) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 524
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.CalculateRiskScoreAsync(Int32 userId, String ipAddress, String location, String deviceFingerprint) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 223
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.IsSuspiciousLoginAsync(Int32 userId, String ipAddress, String userAgent, String location) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 212
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.LogLoginAsync(Int32 userId, String ipAddress, String userAgent, Boolean isSuccessful, String failureReason) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 35
ClientConnectionId:6bef7a38-cda0-41be-b42b-062c6de85f48
Error Number:208,State:1,Class:16
2025-10-03 15:21:44.296 +07:00 [ERR] Error during login for user admin
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'TrustedDevices'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__209_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.IsNewDeviceAsync(Int32 userId, String deviceFingerprint) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 524
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.CalculateRiskScoreAsync(Int32 userId, String ipAddress, String location, String deviceFingerprint) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 223
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.IsSuspiciousLoginAsync(Int32 userId, String ipAddress, String userAgent, String location) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 212
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.LogLoginAsync(Int32 userId, String ipAddress, String userAgent, Boolean isSuccessful, String failureReason) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 35
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.LogFailedLoginAsync(Int32 userId, String ipAddress, String userAgent, String failureReason) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 131
   at FertilizerWarehouseAPI.Controllers.AuthController.Login(LoginDto loginDto) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Controllers\AuthController.cs:line 59
ClientConnectionId:6bef7a38-cda0-41be-b42b-062c6de85f48
Error Number:208,State:1,Class:16
2025-10-03 15:21:59.178 +07:00 [ERR] Failed executing DbCommand (3ms) [Parameters=[@__userId_0='?' (DbType = Int32), @__deviceFingerprint_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [TrustedDevices] AS [t]
        WHERE [t].[UserId] = @__userId_0 AND [t].[DeviceFingerprint] = @__deviceFingerprint_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-03 15:21:59.184 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'FertilizerWarehouseAPI.Data.ApplicationDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'TrustedDevices'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__209_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:6bef7a38-cda0-41be-b42b-062c6de85f48
Error Number:208,State:1,Class:16
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'TrustedDevices'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__209_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:6bef7a38-cda0-41be-b42b-062c6de85f48
Error Number:208,State:1,Class:16
2025-10-03 15:21:59.191 +07:00 [ERR] Error logging login for user 3
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'TrustedDevices'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__209_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.IsNewDeviceAsync(Int32 userId, String deviceFingerprint) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 524
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.CalculateRiskScoreAsync(Int32 userId, String ipAddress, String location, String deviceFingerprint) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 223
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.IsSuspiciousLoginAsync(Int32 userId, String ipAddress, String userAgent, String location) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 212
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.LogLoginAsync(Int32 userId, String ipAddress, String userAgent, Boolean isSuccessful, String failureReason) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 35
ClientConnectionId:6bef7a38-cda0-41be-b42b-062c6de85f48
Error Number:208,State:1,Class:16
2025-10-03 15:21:59.198 +07:00 [ERR] Error during login for user admin
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'TrustedDevices'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__209_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.IsNewDeviceAsync(Int32 userId, String deviceFingerprint) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 524
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.CalculateRiskScoreAsync(Int32 userId, String ipAddress, String location, String deviceFingerprint) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 223
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.IsSuspiciousLoginAsync(Int32 userId, String ipAddress, String userAgent, String location) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 212
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.LogLoginAsync(Int32 userId, String ipAddress, String userAgent, Boolean isSuccessful, String failureReason) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 35
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.LogFailedLoginAsync(Int32 userId, String ipAddress, String userAgent, String failureReason) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 131
   at FertilizerWarehouseAPI.Controllers.AuthController.Login(LoginDto loginDto) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Controllers\AuthController.cs:line 59
ClientConnectionId:6bef7a38-cda0-41be-b42b-062c6de85f48
Error Number:208,State:1,Class:16
2025-10-03 15:22:27.394 +07:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [LoginHistories] AS [l]
WHERE [l].[UserId] = @__userId_0 AND [l].[Action] = N'FailedLogin' AND [l].[Timestamp] > DATEADD(minute, CAST(15.0E0 AS int), GETUTCDATE())
2025-10-03 15:22:27.397 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'FertilizerWarehouseAPI.Data.ApplicationDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__209_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:6bef7a38-cda0-41be-b42b-062c6de85f48
Error Number:208,State:1,Class:16
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__209_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:6bef7a38-cda0-41be-b42b-062c6de85f48
Error Number:208,State:1,Class:16
2025-10-03 15:22:27.401 +07:00 [ERR] Error during login for user admin
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__209_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.ShouldLockAccountAsync(Int32 userId) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 438
   at FertilizerWarehouseAPI.Controllers.AuthController.Login(LoginDto loginDto) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Controllers\AuthController.cs:line 81
ClientConnectionId:6bef7a38-cda0-41be-b42b-062c6de85f48
Error Number:208,State:1,Class:16
2025-10-03 15:28:33.064 +07:00 [ERR] Failed executing DbCommand (2ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [LoginHistories] AS [l]
WHERE [l].[UserId] = @__userId_0 AND [l].[Action] = N'FailedLogin' AND [l].[Timestamp] > DATEADD(minute, CAST(15.0E0 AS int), GETUTCDATE())
2025-10-03 15:28:33.068 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'FertilizerWarehouseAPI.Data.ApplicationDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__209_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:cd34da67-e170-4c53-9fdd-52074ccaef4f
Error Number:208,State:1,Class:16
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__209_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:cd34da67-e170-4c53-9fdd-52074ccaef4f
Error Number:208,State:1,Class:16
2025-10-03 15:28:33.075 +07:00 [ERR] Error during login for user admin
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__209_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.ShouldLockAccountAsync(Int32 userId) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 438
   at FertilizerWarehouseAPI.Controllers.AuthController.Login(LoginDto loginDto) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Controllers\AuthController.cs:line 81
ClientConnectionId:cd34da67-e170-4c53-9fdd-52074ccaef4f
Error Number:208,State:1,Class:16
2025-10-03 15:28:40.822 +07:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [LoginHistories] AS [l]
WHERE [l].[UserId] = @__userId_0 AND [l].[Action] = N'FailedLogin' AND [l].[Timestamp] > DATEADD(minute, CAST(15.0E0 AS int), GETUTCDATE())
2025-10-03 15:28:40.825 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'FertilizerWarehouseAPI.Data.ApplicationDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:cd34da67-e170-4c53-9fdd-52074ccaef4f
Error Number:208,State:1,Class:16
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:cd34da67-e170-4c53-9fdd-52074ccaef4f
Error Number:208,State:1,Class:16
2025-10-03 15:28:40.829 +07:00 [ERR] Error during login for user admin
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.ShouldLockAccountAsync(Int32 userId) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 438
   at FertilizerWarehouseAPI.Controllers.AuthController.Login(LoginDto loginDto) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Controllers\AuthController.cs:line 81
ClientConnectionId:cd34da67-e170-4c53-9fdd-52074ccaef4f
Error Number:208,State:1,Class:16
2025-10-03 15:29:17.221 +07:00 [ERR] Failed executing DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [LoginHistories] AS [l]
WHERE [l].[UserId] = @__userId_0 AND [l].[Action] = N'FailedLogin' AND [l].[Timestamp] > DATEADD(minute, CAST(15.0E0 AS int), GETUTCDATE())
2025-10-03 15:29:17.223 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'FertilizerWarehouseAPI.Data.ApplicationDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:cd34da67-e170-4c53-9fdd-52074ccaef4f
Error Number:208,State:1,Class:16
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:cd34da67-e170-4c53-9fdd-52074ccaef4f
Error Number:208,State:1,Class:16
2025-10-03 15:29:17.227 +07:00 [ERR] Error during login for user admin
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.ShouldLockAccountAsync(Int32 userId) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 438
   at FertilizerWarehouseAPI.Controllers.AuthController.Login(LoginDto loginDto) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Controllers\AuthController.cs:line 81
ClientConnectionId:cd34da67-e170-4c53-9fdd-52074ccaef4f
Error Number:208,State:1,Class:16
2025-10-03 15:30:58.231 +07:00 [INF] Starting create-admin process
2025-10-03 15:30:58.248 +07:00 [INF] Admin user already exists
2025-10-03 15:31:10.323 +07:00 [INF] Admin user unlocked successfully
2025-10-03 15:31:20.196 +07:00 [ERR] Failed executing DbCommand (2ms) [Parameters=[@__userId_0='?' (DbType = Int32), @__deviceFingerprint_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [TrustedDevices] AS [t]
        WHERE [t].[UserId] = @__userId_0 AND [t].[DeviceFingerprint] = @__deviceFingerprint_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-03 15:31:20.200 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'FertilizerWarehouseAPI.Data.ApplicationDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'TrustedDevices'.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:cd34da67-e170-4c53-9fdd-52074ccaef4f
Error Number:208,State:1,Class:16
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'TrustedDevices'.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:cd34da67-e170-4c53-9fdd-52074ccaef4f
Error Number:208,State:1,Class:16
2025-10-03 15:31:20.204 +07:00 [ERR] Error logging login for user 3
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'TrustedDevices'.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.IsNewDeviceAsync(Int32 userId, String deviceFingerprint) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 524
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.CalculateRiskScoreAsync(Int32 userId, String ipAddress, String location, String deviceFingerprint) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 223
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.IsSuspiciousLoginAsync(Int32 userId, String ipAddress, String userAgent, String location) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 212
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.LogLoginAsync(Int32 userId, String ipAddress, String userAgent, Boolean isSuccessful, String failureReason) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 35
ClientConnectionId:cd34da67-e170-4c53-9fdd-52074ccaef4f
Error Number:208,State:1,Class:16
2025-10-03 15:31:20.212 +07:00 [ERR] Error during login for user admin
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'TrustedDevices'.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.IsNewDeviceAsync(Int32 userId, String deviceFingerprint) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 524
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.CalculateRiskScoreAsync(Int32 userId, String ipAddress, String location, String deviceFingerprint) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 223
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.IsSuspiciousLoginAsync(Int32 userId, String ipAddress, String userAgent, String location) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 212
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.LogLoginAsync(Int32 userId, String ipAddress, String userAgent, Boolean isSuccessful, String failureReason) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 35
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.LogFailedLoginAsync(Int32 userId, String ipAddress, String userAgent, String failureReason) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 131
   at FertilizerWarehouseAPI.Controllers.AuthController.Login(LoginDto loginDto) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Controllers\AuthController.cs:line 59
ClientConnectionId:cd34da67-e170-4c53-9fdd-52074ccaef4f
Error Number:208,State:1,Class:16
2025-10-03 15:32:37.847 +07:00 [INF] Database migration completed successfully
2025-10-03 15:32:38.258 +07:00 [INF] Permissions data seeded successfully
2025-10-03 15:32:38.263 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 15:33:02.750 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 15:33:02.874 +07:00 [INF] Debug login attempt for user: admin
2025-10-03 15:33:30.666 +07:00 [INF] Debug login attempt for user: admin
2025-10-03 15:35:14.967 +07:00 [INF] Debug login attempt for user: admin123
2025-10-03 15:35:18.657 +07:00 [INF] Debug login attempt for user: admin123
2025-10-03 15:35:28.485 +07:00 [INF] Debug login attempt for user: admin123
2025-10-03 15:36:00.255 +07:00 [INF] Debug login attempt for user: admin123
2025-10-03 15:36:20.325 +07:00 [INF] Debug login attempt for user: admin123
2025-10-03 15:36:28.336 +07:00 [INF] Debug login attempt for user: admin
2025-10-03 15:36:58.089 +07:00 [INF] Debug login attempt for user: admin123
2025-10-03 15:39:53.924 +07:00 [INF] Debug login attempt for user: admin123
2025-10-03 15:40:41.012 +07:00 [INF] Database migration completed successfully
2025-10-03 15:40:41.478 +07:00 [INF] Permissions data seeded successfully
2025-10-03 15:40:41.485 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 15:40:55.696 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 15:40:55.803 +07:00 [INF] Debug login attempt for user: admin123
2025-10-03 15:41:05.769 +07:00 [INF] Debug login attempt for user: admin123
2025-10-03 15:41:08.424 +07:00 [INF] Debug login attempt for user: admin123
2025-10-03 15:41:13.009 +07:00 [INF] Debug login attempt for user: admin123
2025-10-03 15:43:58.516 +07:00 [INF] Debug login attempt for user: 2180607167
2025-10-03 15:44:48.741 +07:00 [INF] Debug login attempt for user: ngocluy1811
2025-10-03 15:44:53.885 +07:00 [INF] Debug login attempt for user: admin
2025-10-03 15:44:58.182 +07:00 [INF] Debug login attempt for user: admin
2025-10-03 15:46:02.240 +07:00 [INF] Debug login attempt for user: 2180607167
2025-10-03 15:48:50.074 +07:00 [INF] Database migration completed successfully
2025-10-03 15:48:50.372 +07:00 [INF] Permissions data seeded successfully
2025-10-03 15:48:50.377 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 15:50:49.476 +07:00 [INF] Database migration completed successfully
2025-10-03 15:50:49.962 +07:00 [INF] Permissions data seeded successfully
2025-10-03 15:50:49.968 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 15:50:53.353 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 15:50:54.321 +07:00 [ERR] Failed executing DbCommand (18ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [LoginHistories] AS [l]
WHERE [l].[UserId] = @__userId_0 AND [l].[Action] = N'FailedLogin' AND [l].[Timestamp] > DATEADD(minute, CAST(15.0E0 AS int), GETUTCDATE())
2025-10-03 15:50:54.351 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'FertilizerWarehouseAPI.Data.ApplicationDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__209_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:a3a0a5f5-d29f-4e18-98a5-dcd0ee69cc51
Error Number:208,State:1,Class:16
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__209_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:a3a0a5f5-d29f-4e18-98a5-dcd0ee69cc51
Error Number:208,State:1,Class:16
2025-10-03 15:50:54.360 +07:00 [ERR] Error during login for user admin
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__209_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.ShouldLockAccountAsync(Int32 userId) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 438
   at FertilizerWarehouseAPI.Controllers.AuthController.Login(LoginDto loginDto) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Controllers\AuthController.cs:line 81
ClientConnectionId:a3a0a5f5-d29f-4e18-98a5-dcd0ee69cc51
Error Number:208,State:1,Class:16
2025-10-03 15:51:15.314 +07:00 [INF] Database migration completed successfully
2025-10-03 15:51:15.770 +07:00 [INF] Permissions data seeded successfully
2025-10-03 15:51:15.780 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 15:54:02.062 +07:00 [INF] Database migration completed successfully
2025-10-03 15:54:02.268 +07:00 [INF] Permissions data seeded successfully
2025-10-03 15:54:02.272 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 15:54:04.884 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 15:54:05.606 +07:00 [ERR] Failed executing DbCommand (5ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [LoginHistories] AS [l]
WHERE [l].[UserId] = @__userId_0 AND [l].[Action] = N'FailedLogin' AND [l].[Timestamp] > DATEADD(minute, CAST(15.0E0 AS int), GETUTCDATE())
2025-10-03 15:54:05.623 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'FertilizerWarehouseAPI.Data.ApplicationDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__209_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:8dae7024-98d0-41be-922f-d3837541ef16
Error Number:208,State:1,Class:16
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__209_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:8dae7024-98d0-41be-922f-d3837541ef16
Error Number:208,State:1,Class:16
2025-10-03 15:54:05.632 +07:00 [ERR] Error during login for user admin
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'LoginHistories'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__209_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at FertilizerWarehouseAPI.Services.Implementations.SecurityService.ShouldLockAccountAsync(Int32 userId) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Services\Implementations\SecurityService.cs:line 438
   at FertilizerWarehouseAPI.Controllers.AuthController.Login(LoginDto loginDto) in C:\Users\TRANG\Desktop\FILE LÀM VIỆC CÔNG TY\UNG DUNG QUAN LY KHO\BACKEND_QUANLYKHO\FertilizerWarehouseAPI\Controllers\AuthController.cs:line 81
ClientConnectionId:8dae7024-98d0-41be-922f-d3837541ef16
Error Number:208,State:1,Class:16
2025-10-03 15:55:43.737 +07:00 [INF] Database migration completed successfully
2025-10-03 15:55:44.108 +07:00 [INF] Permissions data seeded successfully
2025-10-03 15:55:44.114 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 15:55:45.553 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 15:55:45.659 +07:00 [INF] Starting create-admin process
2025-10-03 15:55:45.956 +07:00 [INF] Admin user already exists
2025-10-03 15:57:23.233 +07:00 [INF] Database migration completed successfully
2025-10-03 15:57:23.533 +07:00 [INF] Permissions data seeded successfully
2025-10-03 15:57:23.538 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 15:57:33.528 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 16:10:25.576 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-10-03 16:10:25.576 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-10-03 16:10:25.576 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-10-03 16:10:25.578 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-10-03 16:10:25.579 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-10-03 16:10:25.579 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-10-03 16:10:25.580 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-10-03 16:10:25.580 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-10-03 16:11:10.624 +07:00 [INF] Permission view_dashboard for role warehouse updated to enabled in database
2025-10-03 16:11:10.627 +07:00 [INF] Toggled permission view_dashboard for role warehouse to enabled
2025-10-03 16:21:43.161 +07:00 [INF] Database migration completed successfully
2025-10-03 16:21:43.447 +07:00 [INF] Permissions data seeded successfully
2025-10-03 16:21:43.455 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 16:22:07.854 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 16:22:27.286 +07:00 [INF] Password reset for user 2180607167 by admin
2025-10-03 16:22:30.855 +07:00 [INF] Password reset for user 2180607167 by admin
2025-10-03 16:22:56.616 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-10-03 16:22:56.616 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-10-03 16:22:56.617 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-10-03 16:22:56.619 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-10-03 16:22:56.619 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-10-03 16:22:56.620 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-10-03 16:22:56.622 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-10-03 16:22:56.624 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-10-03 16:32:26.088 +07:00 [INF] Database migration completed successfully
2025-10-03 16:32:26.373 +07:00 [INF] Permissions data seeded successfully
2025-10-03 16:32:26.379 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 16:32:43.103 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 16:34:41.588 +07:00 [INF] Database migration completed successfully
2025-10-03 16:34:41.890 +07:00 [INF] Permissions data seeded successfully
2025-10-03 16:34:41.896 +07:00 [INF] Starting Fertilizer Warehouse API
2025-10-03 16:34:46.299 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 16:35:37.184 +07:00 [INF] Profile updated for user admin
2025-10-03 16:36:35.189 +07:00 [INF] Profile updated for user admin
2025-10-03 16:36:43.174 +07:00 [INF] Profile updated for user admin
2025-10-03 16:37:11.990 +07:00 [INF] Password reset for user testadmin by admin
2025-10-03 16:38:01.902 +07:00 [INF] Password reset for user testadmin by admin
2025-10-03 17:01:53.348 +07:00 [INF] Updated permissions for role admin. Enabled permissions: 98
2025-10-03 17:01:53.351 +07:00 [INF] Enabled permissions: all, view_warehouse, edit_warehouse, manage_locations, view_cell_details, customize_warehouse, warehouse_config, use_warehouse_filters, drag_drop_position, transfer_goods, empty_cell, manage_clusters, create_cluster, view_production, manage_production, create_production_order, edit_production_order, delete_production_order, manage_machines, manage_production_schedule, view_employees, view_employee_performance, assign_staff, manage_permissions, manage_users, view_staff_info, view_reports, export_reports, view_activities, print_reports, schedule_reports, inventory_check, initiate_inventory_check, perform_inventory_check, verify_inventory_check, approve_inventory_adjustments, view_inventory_check_history, inventory_detail, view_alerts, manage_alerts, create_alert, delete_alert, manage_settings, view_products, edit_products, delete_products, import_products, export_products, track_products, manage_products, manage_inventory, view_maintenance_schedule, create_maintenance_task, assign_maintenance_task, mark_task_complete, maintenance, view_leave_requests, manage_leave_requests, create_leave_requests, edit_leave_requests, approve_leave_requests, reject_leave_requests, delete_leave_requests, cancel_leave_requests, view_notifications, manage_notifications, create_notifications, edit_notifications, delete_notifications, send_notifications, view_attendance, manage_attendance, create_attendance, edit_attendance, delete_attendance, export_attendance, approve_attendance, reject_attendance, view_import_export_orders, create_import_orders, create_export_orders, edit_import_export_orders, delete_import_export_orders, print_import_export_orders, view_suppliers, manage_suppliers, edit_suppliers, delete_suppliers, view_categories, manage_categories, edit_categories, delete_categories, view_users, edit_users, delete_users, view_dashboard, customize_dashboard, export_dashboard
2025-10-03 17:01:53.369 +07:00 [INF] Updated permissions for role warehouse. Enabled permissions: 14
2025-10-03 17:01:53.370 +07:00 [INF] Enabled permissions: view_warehouse, view_cell_details, use_warehouse_filters, view_products, import_products, export_products, track_products, manage_inventory, view_dashboard, perform_inventory_check, view_inventory_check_history, view_leave_requests, create_leave_requests, view_notifications
2025-10-03 17:01:53.382 +07:00 [INF] Updated permissions for role team_leader. Enabled permissions: 27
2025-10-03 17:01:53.382 +07:00 [INF] Enabled permissions: view_warehouse, edit_warehouse, manage_locations, view_products, edit_products, manage_products, view_employees, view_employee_performance, view_reports, view_dashboard, view_production, manage_production, customize_warehouse, warehouse_config, view_maintenance_schedule, create_maintenance_task, initiate_inventory_check, approve_inventory_adjustments, view_alerts, view_leave_requests, create_leave_requests, approve_leave_requests, reject_leave_requests, view_notifications, create_notifications, edit_notifications, delete_notifications
2025-10-03 17:01:53.388 +07:00 [INF] Updated permissions for role sales. Enabled permissions: 9
2025-10-03 17:01:53.388 +07:00 [INF] Enabled permissions: view_products, view_warehouse, export_products, view_reports, view_dashboard, view_alerts, view_leave_requests, create_leave_requests, view_notifications
2025-10-03 17:03:51.251 +07:00 [INF] Permission view_dashboard for role admin updated to disabled in database
2025-10-03 17:03:51.252 +07:00 [INF] Toggled permission view_dashboard for role admin to disabled
2025-10-03 17:03:57.502 +07:00 [INF] Permission view_dashboard for role admin updated to enabled in database
2025-10-03 17:03:57.504 +07:00 [INF] Toggled permission view_dashboard for role admin to enabled
2025-10-03 17:09:23.694 +07:00 [INF] Updated permissions for role admin. Enabled permissions: 98
2025-10-03 17:09:23.696 +07:00 [INF] Enabled permissions: all, view_warehouse, edit_warehouse, manage_locations, view_cell_details, customize_warehouse, warehouse_config, use_warehouse_filters, drag_drop_position, transfer_goods, empty_cell, manage_clusters, create_cluster, view_production, manage_production, create_production_order, edit_production_order, delete_production_order, manage_machines, manage_production_schedule, view_employees, view_employee_performance, assign_staff, manage_permissions, manage_users, view_staff_info, view_reports, export_reports, view_activities, print_reports, schedule_reports, inventory_check, initiate_inventory_check, perform_inventory_check, verify_inventory_check, approve_inventory_adjustments, view_inventory_check_history, inventory_detail, view_alerts, manage_alerts, create_alert, delete_alert, manage_settings, view_products, edit_products, delete_products, import_products, export_products, track_products, manage_products, manage_inventory, view_maintenance_schedule, create_maintenance_task, assign_maintenance_task, mark_task_complete, maintenance, view_leave_requests, manage_leave_requests, create_leave_requests, edit_leave_requests, approve_leave_requests, reject_leave_requests, delete_leave_requests, cancel_leave_requests, view_notifications, manage_notifications, create_notifications, edit_notifications, delete_notifications, send_notifications, view_attendance, manage_attendance, create_attendance, edit_attendance, delete_attendance, export_attendance, approve_attendance, reject_attendance, view_import_export_orders, create_import_orders, create_export_orders, edit_import_export_orders, delete_import_export_orders, print_import_export_orders, view_suppliers, manage_suppliers, edit_suppliers, delete_suppliers, view_categories, manage_categories, edit_categories, delete_categories, view_users, edit_users, delete_users, view_dashboard, customize_dashboard, export_dashboard
2025-10-03 17:09:23.712 +07:00 [INF] Updated permissions for role warehouse. Enabled permissions: 14
2025-10-03 17:09:23.715 +07:00 [INF] Enabled permissions: view_warehouse, view_cell_details, use_warehouse_filters, view_products, import_products, export_products, track_products, manage_inventory, view_dashboard, perform_inventory_check, view_inventory_check_history, view_leave_requests, create_leave_requests, view_notifications
2025-10-03 17:09:23.728 +07:00 [INF] Updated permissions for role team_leader. Enabled permissions: 27
2025-10-03 17:09:23.729 +07:00 [INF] Enabled permissions: view_warehouse, edit_warehouse, manage_locations, view_products, edit_products, manage_products, view_employees, view_employee_performance, view_reports, view_dashboard, view_production, manage_production, customize_warehouse, warehouse_config, view_maintenance_schedule, create_maintenance_task, initiate_inventory_check, approve_inventory_adjustments, view_alerts, view_leave_requests, create_leave_requests, approve_leave_requests, reject_leave_requests, view_notifications, create_notifications, edit_notifications, delete_notifications
2025-10-03 17:09:23.742 +07:00 [INF] Updated permissions for role sales. Enabled permissions: 9
2025-10-03 17:09:23.745 +07:00 [INF] Enabled permissions: view_products, view_warehouse, export_products, view_reports, view_dashboard, view_alerts, view_leave_requests, create_leave_requests, view_notifications
2025-10-03 17:09:59.824 +07:00 [INF] Password reset for user testadmin by admin
